<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Forever Love ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@300;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #ff4d6d; --secondary: #ff85a1; }
        body { margin: 0; overflow: hidden; font-family: 'Quicksand', sans-serif; background: #0a0a0a; }
        #canvas-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        .glass-card.active { display: block; opacity: 1; z-index: 100; }
        .handwritten { font-family: 'Dancing Script', cursive; font-size: 3rem; color: var(--primary); }
        
        .btn-love {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white; padding: 12px 35px; border-radius: 100px;
            font-weight: bold; text-transform: uppercase; cursor: pointer; border: none;
        }

        #rabbit-gift {
            position: absolute; bottom: -200px; left: 50%;
            transform: translateX(-50%); z-index: 200;
            transition: all 1s ease-out; width: 150px;
        }

        input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--secondary);
            color: white; padding: 10px; border-radius: 10px;
            text-align: center; font-size: 1.2rem; outline: none;
        }
    </style>
</head>
<body>

    <audio id="bgMusic" loop>
        <source src="https://www.bensound.com/bensound-music/bensound-cute.mp3" type="audio/mpeg">
    </audio>

    <div id="canvas-container"></div>

    <div id="app" class="flex items-center justify-center h-screen relative z-10">
        <div class="step glass-card active p-10 max-w-sm w-full text-center" id="step0">
            <div class="emoji text-4xl mb-4">üîê</div>
            <h2 class="text-white text-xl mb-6">Nh·∫≠p m√£ b√≠ m·∫≠t ƒë·ªÉ m·ªü m√≥n qu√†...</h2>
            <input type="password" id="passInput" placeholder="Ng√†y sinh (8 ch·ªØ s·ªë)" class="w-full mb-4">
            <p id="error-msg" class="text-red-400 text-sm hidden mb-4">Sai r·ªìi n√®, th·ª≠ l·∫°i ƒëi c√¥ng ch√∫a!</p>
            <button class="btn-love" id="btn-unlock">M·ªü kho√° ‚ù§Ô∏è</button>
        </div>

        <div class="step glass-card p-10 max-w-md w-full text-center" id="step1">
            <div class="handwritten mb-4">Xin ch√†o c√¥ng ch√∫a...</div>
            <p class="text-white/80 text-lg mb-8">Anh c√≥ m·ªôt ƒëi·ªÅu nh·ªè b√© mu·ªën d√†nh ri√™ng cho em.</p>
            <button class="btn-love" id="btn-1">Kh√°m ph√° ngay ‚ù§Ô∏è</button>
        </div>

        <div class="step glass-card p-10 max-w-md w-full text-center" id="step2">
            <h2 class="text-3xl font-bold text-white mb-6">Happy Birthday, My Everything! üéÇ</h2>
            <p class="text-white/70 mb-6">Ch√∫c m·ª´ng sinh nh·∫≠t c√¥ g√°i 12/01/2006 c·ªßa anh!</p>
            <button class="btn-love" id="btn-2">Ti·∫øp t·ª•c n√†o ‚ú®</button>
        </div>

        <div class="step glass-card p-10 max-w-md w-full text-center" id="step3">
            <h2 class="text-2xl font-bold text-white mb-8 italic">ƒêi·ªÅu g√¨ khi·∫øn em ƒë·∫∑c bi·ªát?</h2>
            <div class="grid grid-cols-2 gap-4 text-white">
                <div class="p-4 bg-white/5 rounded-2xl border border-white/10">üíñ D·ªãu d√†ng</div>
                <div class="p-4 bg-white/5 rounded-2xl border border-white/10">üòä N·ª• c∆∞·ªùi</div>
            </div>
            <button class="btn-love mt-8" id="btn-3">B·∫•t ng·ªù cu·ªëi... üéÅ</button>
        </div>

        <div class="step glass-card p-10 max-w-md w-full text-center" id="step4">
            <div class="handwritten mb-6">G·ª≠i t·ªõi ng∆∞·ªùi anh th∆∞∆°ng...</div>
            <div id="typing-text" class="text-white text-xl leading-loose min-h-[120px]"></div>
            <button class="btn-love mt-8" id="final-btn" style="display: none;">Y√™u em m√£i m√£i! ‚ù§Ô∏è</button>
        </div>

        <div id="rabbit-gift">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExOHpueWtzZndzNXp3bmpsZnZidW9scXF6bmZ2ZzB6Z3Z6Z3Z6Z3Z6JmVwPXYxX2ludGVybmFsX2dpZl9ieV9pZCZjdD1z/v06K28H151P2/giphy.gif" alt="Rabbit with chocolate">
            <p class="text-pink-400 font-bold text-center mt-2 bg-white/80 rounded-lg">Socola t·∫∑ng em! üç´</p>
        </div>
    </div>

    <script>
        // 1. Three.js Background (Tr√°i tim bay)
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);
        camera.position.z = 30;

        const heartShape = new THREE.Shape();
        heartShape.moveTo(0,0); heartShape.bezierCurveTo(0,0,-1,1,-2,1); heartShape.bezierCurveTo(-4,1,-4,-1.5,-4,-1.5);
        heartShape.bezierCurveTo(-4,-3,-2,-5,0,-7); heartShape.bezierCurveTo(2,-5,4,-3,4,-1.5); heartShape.bezierCurveTo(4,-1.5,4,1,2,1);
        const hearts = [];
        for(let i=0; i<35; i++){
            const mesh = new THREE.Mesh(new THREE.ShapeGeometry(heartShape), new THREE.MeshBasicMaterial({ color: 0xff4d6d, transparent: true, opacity: 0.4 }));
            mesh.position.set(Math.random()*80-40, Math.random()*80-40, Math.random()*40-20);
            mesh.rotation.z = Math.PI; mesh.scale.set(0.4, 0.4, 0.4);
            scene.add(mesh); hearts.push(mesh);
        }

        function animate() {
            requestAnimationFrame(animate);
            hearts.forEach(h => { h.position.y += 0.05; if(h.position.y > 30) h.position.y = -30; });
            renderer.render(scene, camera);
        }
        animate();

        // 2. Logic ch√≠nh
        function showStep(currentId, nextId) {
            const curr = document.getElementById(currentId);
            const next = document.getElementById(nextId);
            gsap.to(curr, { opacity: 0, scale: 0.8, duration: 0.5, onComplete: () => {
                curr.style.display = 'none';
                next.style.display = 'block';
                gsap.fromTo(next, { opacity: 0, scale: 0.8 }, { opacity: 1, scale: 1, duration: 0.8 });
            }});
        }

        // Check Password
        document.getElementById('btn-unlock').onclick = () => {
            const pass = document.getElementById('passInput').value;
            if(pass === "12012006") {
                showStep('step0', 'step1');
            } else {
                document.getElementById('error-msg').classList.remove('hidden');
                gsap.fromTo("#step0", { x: -10 }, { x: 10, duration: 0.1, repeat: 5, yoyo: true });
            }
        };

        // ƒêi·ªÅu h∆∞·ªõng
        document.getElementById('btn-1').onclick = () => {
            document.getElementById('bgMusic').play();
            showStep('step1', 'step2');
        };
        document.getElementById('btn-2').onclick = () => showStep('step2', 'step3');
        document.getElementById('btn-3').onclick = () => { showStep('step3', 'step4'); startTyping(); };

        // Typing Effect
        function startTyping() {
            const msgs = ["Ch√∫c m·ª´ng sinh nh·∫≠t t√¨nh y√™u c·ªßa anh! ‚ù§Ô∏è", "C·∫£m ∆°n em v√¨ ƒë√£ ƒë·∫øn...", "Anh s·∫Ω lu√¥n ·ªü ƒë√¢y b√™n c·∫°nh em."];
            let l = 0, c = 0; const t = document.getElementById('typing-text');
            function type() {
                if(l < msgs.length) {
                    if(c < msgs[l].length) { t.innerHTML += msgs[l].charAt(c); c++; setTimeout(type, 60); }
                    else { t.innerHTML += "<br>"; l++; c=0; setTimeout(type, 700); }
                } else {
                    document.getElementById('final-btn').style.display = 'inline-block';
                }
            }
            type();
        }

        // 3. K·∫æT TH√öC: Th·ªè t·∫∑ng qu√†
        document.getElementById('final-btn').onclick = function() {
            // Hi·ªáu ·ª©ng ph√°o hoa
            const end = Date.now() + 5000;
            (function frame() {
                confetti({ particleCount: 3, angle: 60, spread: 55, origin: { x: 0 }, shapes: ['heart'] });
                confetti({ particleCount: 3, angle: 120, spread: 55, origin: { x: 1 }, shapes: ['heart'] });
                if (Date.now() < end) requestAnimationFrame(frame);
            }());

            // Th·ªè xu·∫•t hi·ªán
            const rabbit = document.getElementById('rabbit-gift');
            rabbit.style.bottom = "10%";
            
            this.innerText = "CH√öC M·ª™NG SINH NH·∫¨T EM! ‚ù§Ô∏è";
            gsap.to(this, { scale: 1.1, repeat: -1, yoyo: true });
        };
    </script>
</body>
</html>
